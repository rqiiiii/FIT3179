{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Interactive line chart with adjustable Y-axis zoom and annotation about motorcycle injuries.",
  "width": 850,
  "height": 450,
  "config": {"view": {"renderer": "svg"}},

  "data": {
    "url": "data/accident_injuries_roaduser.csv",
    "format": {"type": "csv"}
  },

  "params": [
    {
      "name": "yMax",
      "value": 50000,
      "bind": {
        "input": "range",
        "min": 1000,
        "max": 50000,
        "step": 3000,
        "name": "Y-Axis (zoom): "
      }
    }
  ],

  "transform": [
    {"calculate": "toNumber(datum.Year)", "as": "YearNum"},
    {
      "aggregate": [
        {"op": "sum", "field": "Value", "as": "TotalInjuries"}
      ],
      "groupby": ["YearNum", "Type of Vehicle"]
    }
  ],

  "layer": [
    {
      "mark": {"type": "line", "point": true},
      "encoding": {
        "x": {"field": "YearNum", "type": "quantitative", "title": "Year"},
        "y": {
          "field": "TotalInjuries",
          "type": "quantitative",
          "title": "Total Injuries",
          "scale": {"domain": [0, {"expr": "yMax"}]}
        },
        "color": {
          "field": "Type of Vehicle",
          "type": "nominal",
          "title": "Road User",
          "scale": {
            "domain": [
              "Bicycle",
              "Trailer/Lorry",
              "Motorcar",
              "Motorcycle",
              "Others",
              "Pedestrian",
              "Bus",
              "Jeep",
              "Vans"
            ],
            "range": [
              "#66c2a5",
              "#fc8d62",
              "#8da0cb",
              "#e78ac3",
              "#a6d854",
              "#e5c494",
              "#6a1ea8",
              "#1e6aa8",
              "#65a81e"
            ]
          }
        }
        ,
        "tooltip": [
          {"field": "YearNum", "title": "Year :"},
          {"field": "Type of Vehicle", "title": "Vehicle Type :"},
          {"field": "TotalInjuries", "title": "Number of Accidents :", "format": ","}
        ]
      }
    },

    {
      "mark": {
        "type": "rect",
        "color": "#e5e5e5ee",
        "cornerRadius": 0
      },
      "data": {"values": [{}]},
      "encoding": {
        "x": {"datum": 2012},
        "x2": {"datum": 2020},
        "y": {"datum": 41000},
        "y2": {"datum": 50000}
      }
    },
    {
      "mark": {
        "type": "text",
        "fontWeight": "normal",
        "fontSize": 14,
        "font": "Arial",
        "align": "left",
        "color": "#333333"
      },
        "data": {"values": [{}]},
      "encoding": {
        "x": {"datum": 2012.2},
        "y": {"datum": 48000},
        "text": {"value": "üèçÔ∏è Motorcycles cause the most injuries each year"}
      }
    },
    {
      "mark": {
        "type": "text",
        "fontSize": 14,
        "font": "Arial",
        "align": "left",
        "color": "#333333"
      },
        "data": {"values": [{}]},
      "encoding": {
        "x": {"datum": 2012.7},
        "y": {"datum": 46000},
        "text": {"value": "due to high usage and limited protection,"}
      }
    },
    {
      "mark": {
        "type": "text",
        "fontSize": 15,
        "font": "Arial",
        "align": "left",
        "color": "#333333"
      },
        "data": {"values": [{}]},
      "encoding": {
        "x": {"datum": 2012.7},
        "y": {"datum": 44000},
        "text": {"value": "increasing accident risks on Malaysian roads."}
      }
    }
  ],

  "view": {"stroke": null}
}
