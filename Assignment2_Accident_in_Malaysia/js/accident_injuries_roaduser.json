{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Interactive line chart with adjustable Y-axis zoom and annotation about motorcycle injuries (legend and colors fixed).",
  "width": 850,
  "height": 450,

  "data": {
    "url": "data/accident_injuries_roaduser.csv",
    "format": {"type": "csv"}
  },

  "params": [
    {
      "name": "yMax",
      "value": 50000,
      "bind": {
        "input": "range",
        "min": 1000,
        "max": 50000,
        "step": 3000,
        "name": "Y-Axis (zoom): "
      }
    }
  ],

  "transform": [
    {
      "calculate": "toNumber(datum.Year)",
      "as": "YearNum"
    },
    {
      "aggregate": [
        {"op": "sum", "field": "Value", "as": "TotalInjuries"}
      ],
      "groupby": ["YearNum", "Type of Vehicle"]
    }
  ],

  "layer": [
    {
      "mark": {"type": "line", "point": true},
      "encoding": {
        "x": {
          "field": "YearNum",
          "type": "quantitative",
          "title": "Year",
          "axis": {"format": "d", "tickCount": 8}
        },
        "y": {
          "field": "TotalInjuries",
          "type": "quantitative",
          "title": "Total Injuries",
          "scale": {"domain": [0, {"expr": "yMax"}]}
        },
        "color": {
          "field": "Type of Vehicle",
          "type": "nominal",
          "title": "Road User",
          "scale": {
            "domain": [
              "Bicycle",
              "Trailer/Lorry",
              "Motorcar",
              "Motorcycle",
              "Others",
              "Pedestrian",
              "Bus",
              "Jeep",
              "Vans"
            ],
            "range": [
              "#66c2a5",
              "#fc8d62",
              "#8da0cb",
              "#e78ac3",
              "#a6d854",
              "#e5c494",
              "#6a1ea8",
              "#1e6aa8",
              "#65a81e"
            ]
          }
        },
        "tooltip": [
          {
            "field": "YearNum",
            "type": "quantitative",
            "title": "Year :",
            "format": "d"
          },
          {
            "field": "Type of Vehicle",
            "type": "nominal",
            "title": "Vehicle Type :"
          },
          {
            "field": "TotalInjuries",
            "type": "quantitative",
            "title": "Number of Accidents :",
            "format": ","
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "text": "üèçÔ∏è Motorcycles caused the most injuries in most years",
        "align": "left",
        "baseline": "top",
        "font": "Arial",
        "fontSize": 14,
        "dx": 70,
        "dy": -220,
        "color": "black"
      }
    }
  ],

  "view": {"stroke": null}
}
